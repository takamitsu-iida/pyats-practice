{#-
CSV形式に変換
parsed変数には下記が格納されている

{'GigabitEthernet1': {'arp_timeout': '04:00:00',
                      'arp_type': 'arpa',
                      'auto_negotiate': True,
                      'bandwidth': 1000000,
                      'counters': {'in_broadcast_pkts': 0,
                                   'in_crc_errors': 0,
                                   'in_errors': 0,
                                   'in_frame': 0,
                                   'in_giants': 0,
                                   'in_ignored': 0,
                                   'in_mac_pause_frames': 0,
                                   'in_multicast_pkts': 0,
                                   'in_no_buffer': 0,
                                   'in_octets': 15097669,
                                   'in_overrun': 0,
                                   'in_pkts': 95023,
                                   'in_runts': 0,
                                   'in_throttles': 0,
                                   'in_watchdog': 0,
                                   'last_clear': 'never',
                                   'out_babble': 0,
                                   'out_broadcast_pkts': 0,
                                   'out_buffer_failure': 0,
                                   'out_buffers_swapped': 0,
                                   'out_collision': 0,
                                   'out_deferred': 0,
                                   'out_errors': 0,
                                   'out_interface_resets': 4,
                                   'out_late_collision': 0,
                                   'out_lost_carrier': 0,
                                   'out_mac_pause_frames': 0,
                                   'out_multicast_pkts': 0,
                                   'out_no_carrier': 0,
                                   'out_octets': 14665962,
                                   'out_pkts': 94004,
                                   'out_underruns': 0,
                                   'out_unknown_protocl_drops': 17,
                                   'rate': {'in_rate': 0,
                                            'in_rate_pkts': 0,
                                            'load_interval': 300,
                                            'out_rate': 0,
                                            'out_rate_pkts': 0}},
                      'delay': 10,
                      'description': 'to r2',
                      'duplex_mode': 'full',
                      'enabled': True,
                      'encapsulations': {'encapsulation': 'arpa'},
                      'flow_control': {'receive': False, 'send': False},
                      'ipv4': {'192.168.12.1/24': {'ip': '192.168.12.1',
                                                   'prefix_length': '24'}},
                      'keepalive': 10,
                      'last_input': '00:00:01',
                      'last_output': '00:00:05',
                      'line_protocol': 'up',
                      'link_type': 'auto',
                      'mac_address': '5002.0001.0000',
                      'media_type': 'Virtual',
                      'mtu': 9000,
                      'oper_status': 'up',
                      'output_hang': 'never',
                      'phys_address': '5002.0001.0000',
                      'port_channel': {'port_channel_member': False},
                      'port_speed': '1000mbps',
                      'queues': {'input_queue_drops': 0,
                                 'input_queue_flushes': 0,
                                 'input_queue_max': 375,
                                 'input_queue_size': 0,
                                 'output_queue_max': 40,
                                 'output_queue_size': 0,
                                 'queue_strategy': 'fifo',
                                 'total_output_drop': 0},
                      'reliability': '255/255',
                      'rxload': '1/255',
                      'txload': '1/255',
                      'type': 'CSR vNIC'},
 'GigabitEthernet2': {'arp_timeout': '04:00:00',
                      'arp_type': 'arpa',
                      'auto_negotiate': True,
                      'bandwidth': 1000000,
                      'counters': {'in_broadcast_pkts': 0,
                                   'in_crc_errors': 0,
                                   'in_errors': 0,
                                   'in_frame': 0,
                                   'in_giants': 0,
                                   'in_ignored': 0,
                                   'in_mac_pause_frames': 0,
                                   'in_multicast_pkts': 0,
                                   'in_no_buffer': 0,
                                   'in_octets': 11719540,
                                   'in_overrun': 0,
                                   'in_pkts': 76511,
                                   'in_runts': 0,
                                   'in_throttles': 0,
                                   'in_watchdog': 0,
                                   'last_clear': 'never',
                                   'out_babble': 0,
                                   'out_broadcast_pkts': 0,
                                   'out_buffer_failure': 0,
                                   'out_buffers_swapped': 0,
                                   'out_collision': 0,
                                   'out_deferred': 0,
                                   'out_errors': 0,
                                   'out_interface_resets': 5,
                                   'out_late_collision': 0,
                                   'out_lost_carrier': 0,
                                   'out_mac_pause_frames': 0,
                                   'out_multicast_pkts': 0,
                                   'out_no_carrier': 0,
                                   'out_octets': 11569060,
                                   'out_pkts': 75507,
                                   'out_underruns': 0,
                                   'out_unknown_protocl_drops': 17,
                                   'rate': {'in_rate': 0,
                                            'in_rate_pkts': 0,
                                            'load_interval': 300,
                                            'out_rate': 0,
                                            'out_rate_pkts': 0}},
                      'delay': 10,
                      'description': 'to r3',
                      'duplex_mode': 'full',
                      'enabled': True,
                      'encapsulations': {'encapsulation': 'arpa'},
                      'flow_control': {'receive': False, 'send': False},
                      'ipv4': {'192.168.13.1/24': {'ip': '192.168.13.1',
                                                   'prefix_length': '24'}},
                      'keepalive': 10,
                      'last_input': '00:00:01',
                      'last_output': '00:00:02',
                      'line_protocol': 'up',
                      'link_type': 'auto',
                      'mac_address': '5002.0001.0001',
                      'media_type': 'Virtual',
                      'mtu': 9000,
                      'oper_status': 'up',
                      'output_hang': 'never',
                      'phys_address': '5002.0001.0001',
                      'port_channel': {'port_channel_member': False},
                      'port_speed': '1000mbps',
                      'queues': {'input_queue_drops': 0,
                                 'input_queue_flushes': 0,
                                 'input_queue_max': 375,
                                 'input_queue_size': 0,
                                 'output_queue_max': 40,
                                 'output_queue_size': 0,
                                 'queue_strategy': 'fifo',
                                 'total_output_drop': 0},
                      'reliability': '255/255',
                      'rxload': '1/255',
                      'txload': '1/255',
                      'type': 'CSR vNIC'},
 'GigabitEthernet3': {'arp_timeout': '04:00:00',
                      'arp_type': 'arpa',
                      'auto_negotiate': True,
                      'bandwidth': 1000000,
                      'counters': {'in_broadcast_pkts': 0,
                                   'in_crc_errors': 0,
                                   'in_errors': 0,
                                   'in_frame': 0,
                                   'in_giants': 0,
                                   'in_ignored': 0,
                                   'in_mac_pause_frames': 0,
                                   'in_multicast_pkts': 0,
                                   'in_no_buffer': 0,
                                   'in_octets': 0,
                                   'in_overrun': 0,
                                   'in_pkts': 0,
                                   'in_runts': 0,
                                   'in_throttles': 0,
                                   'in_watchdog': 0,
                                   'last_clear': 'never',
                                   'out_babble': 0,
                                   'out_broadcast_pkts': 0,
                                   'out_buffer_failure': 0,
                                   'out_buffers_swapped': 0,
                                   'out_collision': 0,
                                   'out_deferred': 0,
                                   'out_errors': 0,
                                   'out_interface_resets': 0,
                                   'out_late_collision': 0,
                                   'out_lost_carrier': 0,
                                   'out_mac_pause_frames': 0,
                                   'out_multicast_pkts': 0,
                                   'out_no_carrier': 0,
                                   'out_octets': 0,
                                   'out_pkts': 0,
                                   'out_underruns': 0,
                                   'out_unknown_protocl_drops': 0,
                                   'rate': {'in_rate': 0,
                                            'in_rate_pkts': 0,
                                            'load_interval': 300,
                                            'out_rate': 0,
                                            'out_rate_pkts': 0}},
                      'delay': 10,
                      'description': 'configured by Genie Conf Object',
                      'duplex_mode': 'full',
                      'enabled': False,
                      'encapsulations': {'encapsulation': 'arpa'},
                      'flow_control': {'receive': False, 'send': False},
                      'keepalive': 10,
                      'last_input': 'never',
                      'last_output': 'never',
                      'line_protocol': 'down',
                      'link_type': 'auto',
                      'mac_address': '5002.0001.0002',
                      'media_type': 'Virtual',
                      'mtu': 1500,
                      'oper_status': 'down',
                      'output_hang': 'never',
                      'phys_address': '5002.0001.0002',
                      'port_channel': {'port_channel_member': False},
                      'port_speed': '1000mbps',
                      'queues': {'input_queue_drops': 0,
                                 'input_queue_flushes': 0,
                                 'input_queue_max': 375,
                                 'input_queue_size': 0,
                                 'output_queue_max': 40,
                                 'output_queue_size': 0,
                                 'queue_strategy': 'fifo',
                                 'total_output_drop': 0},
                      'reliability': '255/255',
                      'rxload': '1/255',
                      'txload': '1/255',
                      'type': 'CSR vNIC'},
 'GigabitEthernet4': {'arp_timeout': '04:00:00',
                      'arp_type': 'arpa',
                      'auto_negotiate': True,
                      'bandwidth': 1000000,
                      'counters': {'in_broadcast_pkts': 0,
                                   'in_crc_errors': 0,
                                   'in_errors': 0,
                                   'in_frame': 0,
                                   'in_giants': 0,
                                   'in_ignored': 0,
                                   'in_mac_pause_frames': 0,
                                   'in_multicast_pkts': 0,
                                   'in_no_buffer': 0,
                                   'in_octets': 0,
                                   'in_overrun': 0,
                                   'in_pkts': 0,
                                   'in_runts': 0,
                                   'in_throttles': 0,
                                   'in_watchdog': 0,
                                   'last_clear': 'never',
                                   'out_babble': 0,
                                   'out_broadcast_pkts': 0,
                                   'out_buffer_failure': 0,
                                   'out_buffers_swapped': 0,
                                   'out_collision': 0,
                                   'out_deferred': 0,
                                   'out_errors': 0,
                                   'out_interface_resets': 0,
                                   'out_late_collision': 0,
                                   'out_lost_carrier': 0,
                                   'out_mac_pause_frames': 0,
                                   'out_multicast_pkts': 0,
                                   'out_no_carrier': 0,
                                   'out_octets': 0,
                                   'out_pkts': 0,
                                   'out_underruns': 0,
                                   'out_unknown_protocl_drops': 0,
                                   'rate': {'in_rate': 0,
                                            'in_rate_pkts': 0,
                                            'load_interval': 300,
                                            'out_rate': 0,
                                            'out_rate_pkts': 0}},
                      'delay': 10,
                      'description': 'configured by Genie Conf Object',
                      'duplex_mode': 'full',
                      'enabled': False,
                      'encapsulations': {'encapsulation': 'arpa'},
                      'flow_control': {'receive': False, 'send': False},
                      'keepalive': 10,
                      'last_input': 'never',
                      'last_output': 'never',
                      'line_protocol': 'down',
                      'link_type': 'auto',
                      'mac_address': '5002.0001.0003',
                      'media_type': 'Virtual',
                      'mtu': 1500,
                      'oper_status': 'down',
                      'output_hang': 'never',
                      'phys_address': '5002.0001.0003',
                      'port_channel': {'port_channel_member': False},
                      'port_speed': '1000mbps',
                      'queues': {'input_queue_drops': 0,
                                 'input_queue_flushes': 0,
                                 'input_queue_max': 375,
                                 'input_queue_size': 0,
                                 'output_queue_max': 40,
                                 'output_queue_size': 0,
                                 'queue_strategy': 'fifo',
                                 'total_output_drop': 0},
                      'reliability': '255/255',
                      'rxload': '1/255',
                      'txload': '1/255',
                      'type': 'CSR vNIC'},
 'Loopback0': {'bandwidth': 8000000,
               'counters': {'in_abort': 0,
                            'in_broadcast_pkts': 0,
                            'in_crc_errors': 0,
                            'in_errors': 0,
                            'in_frame': 0,
                            'in_giants': 0,
                            'in_ignored': 0,
                            'in_multicast_pkts': 0,
                            'in_no_buffer': 0,
                            'in_octets': 0,
                            'in_overrun': 0,
                            'in_pkts': 0,
                            'in_runts': 0,
                            'in_throttles': 0,
                            'last_clear': 'never',
                            'out_broadcast_pkts': 0,
                            'out_buffer_failure': 0,
                            'out_buffers_swapped': 0,
                            'out_collision': 0,
                            'out_errors': 0,
                            'out_interface_resets': 0,
                            'out_multicast_pkts': 0,
                            'out_octets': 0,
                            'out_pkts': 0,
                            'out_underruns': 0,
                            'out_unknown_protocl_drops': 0,
                            'rate': {'in_rate': 0,
                                     'in_rate_pkts': 0,
                                     'load_interval': 300,
                                     'out_rate': 0,
                                     'out_rate_pkts': 0}},
               'delay': 5000,
               'enabled': True,
               'encapsulations': {'encapsulation': 'loopback'},
               'ipv4': {'192.168.255.1/32': {'ip': '192.168.255.1',
                                             'prefix_length': '32'}},
               'keepalive': 10,
               'last_input': '1d05h',
               'last_output': '1d05h',
               'line_protocol': 'up',
               'mtu': 1514,
               'oper_status': 'up',
               'output_hang': 'never',
               'port_channel': {'port_channel_member': False},
               'queues': {'input_queue_drops': 0,
                          'input_queue_flushes': 0,
                          'input_queue_max': 75,
                          'input_queue_size': 0,
                          'output_queue_max': 0,
                          'output_queue_size': 0,
                          'queue_strategy': 'fifo',
                          'total_output_drop': 0},
               'reliability': '255/255',
               'rxload': '1/255',
               'txload': '1/255',
               'type': 'Loopback'}}
-#}
Interface,Description,Type,Enabled,Bandwidth,Port Speed,Port Duplex,IPv4 Address,Line Protocol,Operational Status,MAC Address,Media Type, Delay,Encapsulation,Keepalive,MTU,Port Channel Member,Member Interface,Input CRC Errors,Input Errors,Output Errors,Input Packets,Output Packets,QoS Strategy,Input Queue Drops,Total Output Drops
{% for name, data in parsed.items() -%}
{{ name }},{{ data.description | d("No Description") }},{{ data.type }},{{ data.enabled | d("Not Enabled" ) | replace(",","")}},{{ data.bandwidth }},{{ data.port_speed | d('-')}},{{ data.duplex_mode | d('-')}},{% if data.ipv4 is defined %}{% for ip_addr in data.ipv4 -%}{{ ip_addr }} {% endfor %}{% else %}-{% endif %},{{ data.line_protocol }},{{ data.oper_status }},{{ data.mac_address }},{{ data.media_type | d('-')}},{{ data.delay }},{{ data.encapsulations.encapsulation }},{{ data.keepalive | d('-')}},{{ data.mtu }},{{ data.port_channel.port_channel_member }},Stand Alone Port,{% if data.counters is defined %}{{ data.counters.in_crc_errors }},{{ data.counters.in_errors }},{{ data.counters.out_errors }},{{ data.counters.in_pkts }},{{ data.counters.out_pkts }},{% else %}-,-,-,-,-,{% endif %}{% if data.queues is defined %}{{ data.queues.queue_strategy }},{{ data.queues.input_queue_drops }},{{ data.queues.total_output_drop }}{% else %}-,-,-{% endif %}
{% endfor %}
